<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pest Detection Tool</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background-color: #f5f5f5; }
    .container { background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    h1 { color: #333; text-align: center; }
    .model-info { text-align: center; color: #666; font-size: 14px; margin-top: 10px; }
    .upload-area { border: 2px dashed #ccc; border-radius: 8px; padding: 40px; text-align: center; margin: 20px 0; cursor: pointer; transition: border-color .3s, background-color .3s; background:#fafafa; }
    .upload-area:hover { border-color: #007bff; }
    .upload-area.dragover { border-color: #007bff; background-color: #f0f8ff; }
    #imageInput { display: none; }
    .preview-container { text-align: center; margin: 20px 0; display: none; }
    #imagePreview { max-width: 100%; max-height: 300px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .actions { display: flex; gap: 12px; justify-content: center; margin-top: 12px; flex-wrap: wrap; }
    a.button, button { background-color: #007bff; color: #fff; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer; font-size: 16px; text-decoration: none; }
    button.ghost { background: #e9ecef; color: #333; }
    #results { margin-top: 20px; padding: 20px; background-color: #f8f9fa; border-radius: 8px; border-left: 4px solid #007bff; display: none; }
    .note { text-align:center; color:#888; font-size:14px; margin: 8px 0 0; }
    .legal { color:#777; font-size:12px; text-align:center; margin-top:24px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>üêõ Pest Detection Tool</h1>
    <p style="text-align:center;color:#666;">Upload an image to identify pests using AI</p>
    <div class="model-info">Secure client ‚Äî analysis runs on Streamlit (server-side)</div>

    <div class="upload-area" id="drop">
      <p>üì∑ Click here or drag & drop an image</p>
      <p style="font-size:14px;color:#666;">Supports JPG, PNG, WebP formats</p>
      <input type="file" id="imageInput" accept="image/*"/>
    </div>

    <div class="preview-container" id="previewContainer">
      <img id="imagePreview" alt="Uploaded image">
      <div class="actions">
        <!-- Adjust href if your Streamlit app is at a different URL -->
        <a class="button" id="openStreamlit" href="/?page=pest" target="_blank" rel="noopener">Open in Streamlit to Analyze</a>
        <button class="ghost" id="clearBtn" type="button">Clear</button>
      </div>
      <p class="note">After opening Streamlit, upload the same image there to run AI analysis securely with server-side keys.</p>
    </div>

    <div id="results"></div>
    <p class="legal">¬© Your Team ‚Ä¢ This static page intentionally performs no API calls and stores no secrets.</p>
  </div>

  <script>
    // Simple, secure client: preview only. No API calls, no secrets.
    const input = document.getElementById('imageInput');
    const drop = document.getElementById('drop');
    const previewContainer = document.getElementById('previewContainer');
    const imagePreview = document.getElementById('imagePreview');
    const clearBtn = document.getElementById('clearBtn');

    drop.addEventListener('click', () => input.click());
    drop.addEventListener('dragover', e => { e.preventDefault(); drop.classList.add('dragover'); });
    drop.addEventListener('dragleave', () => drop.classList.remove('dragover'));
    drop.addEventListener('drop', e => {
      e.preventDefault(); drop.classList.remove('dragover');
      const files = e.dataTransfer.files;
      if (files && files.length) handleFile(files[0]);
    });
    input.addEventListener('change', e => { if (e.target.files && e.target.files.length) handleFile(e.target.files[0]); });
    clearBtn.addEventListener('click', () => {
      input.value = '';
      imagePreview.src = '';
      previewContainer.style.display = 'none';
    });

    function handleFile(file) {
      if (!file.type.startsWith('image/')) return alert('Please select an image file.');
      const reader = new FileReader();
      reader.onload = e => {
        imagePreview.src = e.target.result;
        previewContainer.style.display = 'block';
      };
      reader.readAsDataURL(file);
    }
  </script>
</body>
</html>
